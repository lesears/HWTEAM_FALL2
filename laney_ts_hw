/*run ARIMA(6,1,6)*/
proc arima data=work.raw_well ;
identify var=x(1);
estimate p=6 q=6 method=ML;
forecast back=168 lead = 168 out = predict ;
run;
quit;

/*Get last 168 obs of x's and predicted values*/
%let obswant=168;
data xvar;
set work.predict nobs=obscount;
if _n_ gt (obscount-&obswant.);
run;

%let obswant=168;
data xvar2;
set work.raw_Well nobs=obscount;
if _n_ gt (obscount-&obswant.);
run;

/*new data set of last 168 obs of each*/
data new;
set xvar;
set xvar2;
run;

/*calculate MAPE for each prediction*/
Proc Sql;
    Create Table Work.mape as
        select distinct
            x,
            forecast,
            ((abs((x - forecast)/x))/168) as MAPE
        from work.new;
 Quit;

/*final MAPE*/
proc sql;
create table work.mape_value as
select (sum(MAPE)*100) as total_mape from work.mape;
quit;
